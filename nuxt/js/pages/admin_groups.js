(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{890:function(e,t,o){"use strict";o.r(t);o(17),o(18);var r={head:function(){return{title:"小组管理 - Saiblo"}},data:function(){return{group_modal:{id:0,name:"",introduction:"",reason:"",open:!1}}},asyncData:function(e){var t,o;return e.app.$axios.get("/api/groups/applying/").then((function(e){t=e.data}),(function(){e.error({statusCode:401,message:"您没有足够的权限"})})).then((function(){return e.app.$axios.get("/api/groups/").then((function(e){return o=e.data,{applying_groups:t,approved_groups:o}}),(function(){e.error({statusCode:401,message:"您没有足够的权限"})}))}))},methods:{read_detail:function(e,t,o,r){this.group_modal.id=e,this.group_modal.name=t,this.group_modal.introduction=o,this.group_modal.reason=r,this.group_modal.open=!0},approve:function(e){var t=this;this.$axios.patch("/api/groups/".concat(e.id,"/"),{permission:!0}).then((function(){t.$notify.success({title:"成功",message:"已通过小组申请",timeout:500}),t.approved_groups.push(e),t.applying_groups=t.applying_groups.filter((function(t){return t.id!=e.id}))}))},reject:function(e){var t=this;this.$axios.patch("/api/groups/".concat(e,"/"),{permission:!1}).then((function(){t.$notify.success({title:"成功",message:"已拒绝小组申请",timeout:500}),t.applying_groups=t.applying_groups.filter((function(t){return t.id!=e}))}))},delete_group:function(e){var t=this;this.$axios.delete("/api/groups/".concat(e,"/")).then((function(){t.$notify.success({title:"成功",message:"已删除小组",timeout:500}),t.approved_groups=t.approved_groups.filter((function(t){return t.id!=e}))}))}}},n=o(7),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("sui-grid",{attrs:{centered:""}},[o("sui-grid-column",[o("sui-header",{tag:"h1"},[e._v("小组管理")]),e._v(" "),o("sui-accordion",{attrs:{fluid:"",styled:"",exclusive:""}},[o("sui-accordion-title",{attrs:{active:""}},[o("sui-icon",{attrs:{name:"dropdown"}}),e._v("小组申请 ")],1),e._v(" "),o("sui-accordion-content",{attrs:{active:""}},[o("sui-table",{attrs:{basic:"very",selectable:"",compact:"very"}},[o("sui-table-header",[o("sui-table-row",[o("sui-table-header-cell",[e._v("组名")]),e._v(" "),o("sui-table-header-cell",[e._v("简介")]),e._v(" "),o("sui-table-header-cell",[e._v("申请理由")]),e._v(" "),o("sui-table-header-cell",[e._v("申请时间")]),e._v(" "),o("sui-table-header-cell",[e._v("申请人")]),e._v(" "),o("sui-table-header-cell")],1)],1),e._v(" "),o("sui-table-body",e._l(e.applying_groups,(function(t){return o("sui-table-row",{key:t.id},[o("sui-table-cell",[o("a",{attrs:{href:""},on:{click:function(o){return o.preventDefault(),e.read_detail(t.id,t.name,t.introduction,t.reason)}}},[e._v(e._s(t.name))])]),e._v(" "),o("sui-table-cell",[e._v(e._s(t.introduction))]),e._v(" "),o("sui-table-cell",[e._v(e._s(t.reason))]),e._v(" "),o("sui-table-cell",[e._v(e._s(e._f("date")(t.created_time,"YYYY-M-D H:mm:ss")))]),e._v(" "),o("sui-table-cell",[e._v(e._s(t.creator))]),e._v(" "),o("sui-table-cell",{attrs:{collapsing:""}},[o("a",{staticStyle:{color:"green"},attrs:{href:""},on:{click:function(o){return o.preventDefault(),e.approve(t)}}},[e._v("通过")]),e._v(" "),o("a",{staticStyle:{color:"red"},attrs:{href:""},on:{click:function(o){return o.preventDefault(),e.reject(t.id)}}},[e._v("不通过")])])],1)})),1)],1)],1),e._v(" "),o("sui-accordion-title",[o("sui-icon",{attrs:{name:"dropdown"}}),e._v("小组列表 ")],1),e._v(" "),o("sui-accordion-content",[o("sui-table",{attrs:{basic:"very",selectable:"",compact:"very"}},[o("sui-table-header",[o("sui-table-row",[o("sui-table-header-cell",[e._v("组名")]),e._v(" "),o("sui-table-header-cell",[e._v("简介")]),e._v(" "),o("sui-table-header-cell",[e._v("申请理由")]),e._v(" "),o("sui-table-header-cell",[e._v("创建时间")]),e._v(" "),o("sui-table-header-cell",[e._v("申请人")]),e._v(" "),o("sui-table-header-cell")],1)],1),e._v(" "),o("sui-table-body",e._l(e.approved_groups,(function(t){return o("sui-table-row",{key:t.id},[o("sui-table-cell",[o("a",{attrs:{href:"/group/"+t.id,target:"_blank"}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])]),e._v(" "),o("sui-table-cell",{on:{click:function(o){return o.preventDefault(),e.read_detail(t.id,t.name,t.introduction,t.reason)}}},[e._v(e._s(t.introduction))]),e._v(" "),o("sui-table-cell",[e._v(e._s(t.reason))]),e._v(" "),o("sui-table-cell",[e._v(e._s(t.time))]),e._v(" "),o("sui-table-cell",[e._v(e._s(t.applicant))]),e._v(" "),o("sui-table-cell",{attrs:{collapsing:""}},[o("a",{staticStyle:{color:"red"},attrs:{href:""},on:{click:function(o){return o.preventDefault(),e.delete_group(t.id)}}},[e._v("删除小组")])])],1)})),1)],1)],1)],1)],1)],1),e._v(" "),o("sui-modal",{attrs:{size:"tiny"},model:{value:e.group_modal.open,callback:function(t){e.$set(e.group_modal,"open",t)},expression:"group_modal.open"}},[o("sui-modal-header",[e._v("小组申请详情")]),e._v(" "),o("sui-modal-content",[o("sui-modal-description",[o("sui-form",[o("sui-form-field",[o("label",[e._v("名称")]),e._v(" "),o("sui-input",{attrs:{readonly:""},model:{value:e.group_modal.name,callback:function(t){e.$set(e.group_modal,"name",t)},expression:"group_modal.name"}})],1),e._v(" "),o("sui-form-field",[o("label",[e._v("简介")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.group_modal.introduction,expression:"group_modal.introduction"}],attrs:{rows:"7",readonly:""},domProps:{value:e.group_modal.introduction},on:{input:function(t){t.target.composing||e.$set(e.group_modal,"introduction",t.target.value)}}})]),e._v(" "),o("sui-form-field",[o("label",[e._v("申请理由")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.group_modal.reason,expression:"group_modal.reason"}],attrs:{rows:"7",readonly:""},domProps:{value:e.group_modal.reason},on:{input:function(t){t.target.composing||e.$set(e.group_modal,"reason",t.target.value)}}})])],1)],1)],1),e._v(" "),o("sui-modal-actions",[o("sui-button",{attrs:{color:"blue"},nativeOn:{click:function(t){e.group_modal.open=!1}}},[e._v("\n                知道了\n                "),o("sui-icon",{attrs:{name:"right angle"}})],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);